<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Supabase Integration</title>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.0.0/dist/umd/supabase.min.js"></script>
</head>
<body>
  <h1>Supabase Integration</h1>
  <button class="fetch">Fetch Items</button>
  <button class="add">Add Item</button>

  <script>
    window.addEventListener('DOMContentLoaded', () => {
      // Your Supabase credentials
      const supabaseUrl = 'https://dieltjdqgeppyixximwe.supabase.co';
      const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRpZWx0amRxZ2VwcHlpeHhpbXdlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDEwMzY2MzMsImV4cCI6MjA1NjYxMjYzM30.NXZfUyvyrPzAeT75vWWWjY5h1LOe_vwaFiHBS1TMwtw';
      const supabaseClient = supabase.createClient(supabaseUrl, supabaseKey);

      // Fetch items from the 'items' table
      async function fetchItems() {
        try {
          const { data, error } = await supabaseClient
            .from('items')
            .select('*');
          if (error) throw error;
          console.log('Items:', data);
        } catch (error) {
          console.error('Error fetching items:', error.message || error);
        }
      }

      // Add an item to the 'items' table
      async function addItem(name, description) {
        try {
          const { data, error } = await supabaseClient
            .from('items')
            .insert([{ name: name, description: description }])
            .select(); // Return the inserted data
          if (error) throw error;
          console.log('Item added:', data);
        } catch (error) {
          console.error('Error adding item:', error.message || error);
        }
      }

      // Event listeners
      document.querySelector('button.fetch').addEventListener('click', fetchItems);
      document.querySelector('button.add').addEventListener('click', () => {
        addItem('Sample Item', 'This is a sample description');
      });

      // Real-time subscription
      supabaseClient
        .channel('public:items')
        .on(
          'postgres_changes',
          { event: 'INSERT', schema: 'public', table: 'items' },
          (payload) => {
            console.log('New item added:', payload.new);
          }
        )
        .subscribe();
    });
  </script>
</body>
</html>
